{
  "version": "2.0.0",
  "description": "PM-controlled business rules for search behavior. Edit this file to change search results without code changes.",
  "globalEnabled": true,
  "rules": [
    {
      "id": "subgenre_interleaving_rock",
      "type": "subgenre_interleaving",
      "enabled": true,
      "priority": 75,
      "pattern": "\\b(rock|rocks|rocky)\\b",
      "description": "Interleave rock subgenres for variety in results",
      "action": {
        "attribute": "genre",
        "values": {
          "A": "Classic Rock",
          "B": "Alternative Rock",
          "C": "Indie Rock",
          "D": "Hard Rock"
        },
        "pattern": "ABCD ABCD ABCD",
        "fallback": "relevance"
      }
    },
    {
      "id": "recency_interleaving_pop",
      "type": "recency_interleaving",
      "enabled": true,
      "priority": 80,
      "pattern": "\\b(pop|contemporary|modern|current|fresh)\\b",
      "description": "Interleave recent and vintage pop tracks (favor recent)",
      "action": {
        "recent_count": 8,
        "vintage_count": 4,
        "recent_threshold_months": 12,
        "vintage_max_months": 60,
        "repeat_count": 3,
        "pattern": "RRRR VRRR VRRR"
      }
    },
    {
      "id": "recency_decay_pop",
      "type": "recency_decay",
      "enabled": true,
      "priority": 65,
      "pattern": "\\b(pop|contemporary|modern)\\b",
      "description": "Gentle recency boost for pop tracks (2-year horizon, 90% at horizon)",
      "action": {
        "horizon_months": 24,
        "horizon_threshold": 0.9,
        "min_factor": 0.65,
        "date_field": "apm_release_date"
      }
    }
  ],
  "templates": {
    "subgenre_interleaving": {
      "description": "Interleave results from different subgenres based on a pattern",
      "example": {
        "id": "subgenre_interleaving_[genre]",
        "type": "subgenre_interleaving",
        "enabled": false,
        "priority": 75,
        "pattern": "\\b(keyword1|keyword2)\\b",
        "description": "Interleave [genre] subgenres for variety",
        "action": {
          "attribute": "genre",
          "values": {
            "A": "Subgenre 1",
            "B": "Subgenre 2",
            "C": "Subgenre 3",
            "D": "Subgenre 4"
          },
          "pattern": "ABCD ABCD ABCD",
          "fallback": "relevance"
        }
      },
      "notes": [
        "Pattern uses letters (A-Z) to represent subgenres",
        "Values map letters to actual genre names from facet_taxonomy",
        "Fallback determines what to do when a slot can't be filled",
        "Spaces in pattern are ignored (for readability)"
      ]
    },
    "genre_simplification": {
      "description": "Auto-expand genre searches to include related subgenres",
      "example": {
        "id": "genre_simplification_[genre]",
        "type": "genre_simplification",
        "enabled": false,
        "priority": 100,
        "pattern": "\\b(keyword1|keyword2)\\b",
        "description": "Auto-expand [genre] to include subgenres",
        "action": {
          "auto_apply_facets": ["Subgenre 1", "Subgenre 2", "Subgenre 3"],
          "mode": "expand"
        }
      },
      "notes": [
        "Facet names must match values in facet_taxonomy table",
        "Mode 'expand' adds subgenres to search (OR logic)",
        "Mode 'restrict' limits to only these subgenres (AND logic)"
      ]
    },
    "library_boost": {
      "description": "Boost tracks from specific libraries for certain queries",
      "example": {
        "id": "library_boost_[context]",
        "type": "library_boost",
        "enabled": false,
        "priority": 90,
        "pattern": "\\b(keyword1|keyword2)\\b",
        "description": "Boost [library] for [context] queries",
        "action": {
          "boost_libraries": [
            {
              "library_name": "Library Name",
              "boost_factor": 1.5
            }
          ]
        }
      },
      "notes": [
        "boost_factor multiplies the relevance score",
        "1.5 = 50% boost, 2.0 = double score, 0.5 = halve score",
        "Multiple libraries can be boosted with different factors"
      ]
    },
    "recency_interleaving": {
      "description": "Mix recent and vintage tracks based on release date",
      "example": {
        "id": "recency_interleaving_[context]",
        "type": "recency_interleaving",
        "enabled": false,
        "priority": 80,
        "pattern": "\\b(keyword1|keyword2)\\b",
        "description": "Interleave recent/vintage for [context]",
        "action": {
          "recent_count": 8,
          "vintage_count": 4,
          "recent_threshold_months": 12,
          "vintage_max_months": 60,
          "pattern": "RRRR VRRR VRRR"
        }
      },
      "notes": [
        "R = recent track (within threshold), V = vintage track",
        "recent_threshold_months defines 'recent' cutoff (e.g., 12 = last 12 months)",
        "vintage_max_months defines oldest allowed vintage (e.g., 60 = max 5 years old)",
        "Tracks older than vintage_max_months are excluded from interleaving",
        "Pattern determines exact ordering of results"
      ]
    },
    "feature_boost": {
      "description": "Boost tracks with specific features/attributes",
      "example": {
        "id": "feature_boost_[feature]",
        "type": "feature_boost",
        "enabled": false,
        "priority": 60,
        "pattern": "\\b(keyword1|keyword2)\\b",
        "description": "Boost tracks with [feature]",
        "action": {
          "boost_field": "has_stems",
          "boost_value": "true",
          "boost_factor": 2.0
        }
      },
      "notes": [
        "boost_field must be a valid field in the tracks index",
        "boost_value is the value to match",
        "boost_factor multiplies score for matching tracks"
      ]
    },
    "filter_optimization": {
      "description": "Auto-apply filters based on query keywords",
      "example": {
        "id": "filter_[context]",
        "type": "filter_optimization",
        "enabled": false,
        "priority": 60,
        "pattern": "\\b(keyword1|keyword2)\\b",
        "description": "Auto-filter for [condition]",
        "action": {
          "auto_apply_filter": {
            "field": "vocals",
            "value": "No Vocals",
            "operator": "contains"
          }
        }
      },
      "notes": [
        "Operators: 'contains', 'contains_any', 'equals', 'not_equals'",
        "For 'contains_any', use comma-separated values",
        "Filter is applied transparently (shown in _meta)"
      ]
    },
    "recency_decay": {
      "description": "Apply logarithmic decay to scores based on track age (gentle recency boost)",
      "example": {
        "id": "recency_decay_[context]",
        "type": "recency_decay",
        "enabled": false,
        "priority": 65,
        "pattern": "\\b(keyword1|keyword2)\\b",
        "description": "Gentle recency boost for [context] (2-year horizon)",
        "action": {
          "horizon_months": 24,
          "horizon_threshold": 0.9,
          "min_factor": 0.65,
          "date_field": "apm_release_date"
        }
      },
      "notes": [
        "Logarithmic decay preserves catalog depth while boosting recent tracks",
        "horizon_months: time window considered 'recent' (default 24)",
        "horizon_threshold: factor at horizon age (0.90 = 90% at 2 years)",
        "min_factor: floor to prevent burying old classics (0.65 = never below 65%)",
        "Expected decay: 0mo=100%, 6mo=97%, 1yr=94%, 2yr=90%, 4yr=84%, 8yr=77%",
        "Works with any search endpoint (Solr, AIMS, etc.)"
      ]
    }
  },
  "disabled_rules": [
    {
      "id": "recency_decay_pop",
      "type": "recency_decay",
      "enabled": false,
      "priority": 65,
      "pattern": "\\b(pop|contemporary|modern)\\b",
      "description": "Gentle recency boost for pop tracks (2-year horizon, 90% at horizon)",
      "action": {
        "horizon_months": 24,
        "horizon_threshold": 0.9,
        "min_factor": 0.65,
        "date_field": "apm_release_date"
      }
    },
    {
      "id": "genre_simplification_rock",
      "type": "genre_simplification",
      "enabled": false,
      "priority": 100,
      "pattern": "\\b(rock|rocks|rocky)\\b",
      "description": "Auto-expand rock search to include major rock subgenres",
      "action": {
        "auto_apply_facets": [
          "Classic Rock",
          "Alternative Rock",
          "Indie Rock",
          "Hard Rock",
          "Punk Rock",
          "Garage Rock",
          "Southern Rock",
          "Blues / Rock",
          "Modern Rock",
          "Surf"
        ],
        "mode": "expand"
      }
    },
    {
      "id": "genre_simplification_classical",
      "type": "genre_simplification",
      "enabled": false,
      "priority": 100,
      "pattern": "\\b(classical|classic)\\b",
      "description": "Auto-expand classical search to include classical periods and styles",
      "action": {
        "auto_apply_facets": [
          "Classical",
          "Classical Styling",
          "Neo Classical",
          "Minimalist Style",
          "20th Century Classical Style",
          "Classical Arrangement",
          "Avant Garde",
          "Classical Fusion",
          "Baroque",
          "Romantic",
          "Modern Classical"
        ],
        "mode": "expand"
      }
    },
    {
      "id": "genre_simplification_electronic",
      "type": "genre_simplification",
      "enabled": false,
      "priority": 100,
      "pattern": "\\b(electronic|electronica|edm)\\b",
      "description": "Auto-expand electronic search to include electronic subgenres",
      "action": {
        "auto_apply_facets": [
          "Club / Electronica",
          "House",
          "Deep House",
          "Tech House",
          "Techno",
          "Trance",
          "Drum and Bass",
          "Dubstep",
          "Ambient",
          "IDM",
          "Synthwave"
        ],
        "mode": "expand"
      }
    },
    {
      "id": "genre_simplification_hip_hop",
      "type": "genre_simplification",
      "enabled": false,
      "priority": 100,
      "pattern": "\\b(hip hop|hip-hop|hiphop|rap)\\b",
      "description": "Auto-expand hip hop search to include rap and hip hop styles",
      "action": {
        "auto_apply_facets": [
          "Hip Hop",
          "Rap",
          "Trap",
          "Boom Bap",
          "Lo-Fi Hip Hop",
          "Alternative Hip Hop",
          "East Coast Hip Hop",
          "West Coast Hip Hop",
          "Southern Hip Hop"
        ],
        "mode": "expand"
      }
    },
    {
      "id": "genre_simplification_jazz",
      "type": "genre_simplification",
      "enabled": false,
      "priority": 100,
      "pattern": "\\b(jazz|jazzy)\\b",
      "description": "Auto-expand jazz search to include jazz styles",
      "action": {
        "auto_apply_facets": [
          "Jazz",
          "Bebop",
          "Cool Jazz",
          "Hard Bop",
          "Modal Jazz",
          "Free Jazz",
          "Fusion",
          "Latin Jazz",
          "Smooth Jazz",
          "Swing",
          "Big Band"
        ],
        "mode": "expand"
      }
    },
    {
      "id": "library_boost_sports_mlb",
      "type": "library_boost",
      "enabled": false,
      "priority": 90,
      "pattern": "\\b(sports?|baseball|stadium|game|athletic)\\b",
      "description": "Boost MLB Music library for sports-related queries",
      "action": {
        "boost_libraries": [
          {
            "library_name": "MLB Music",
            "boost_factor": 1.5
          }
        ]
      }
    },
    {
      "id": "library_boost_sports_nfl",
      "type": "library_boost",
      "enabled": false,
      "priority": 90,
      "pattern": "\\b(football|nfl|sports?|stadium|game)\\b",
      "description": "Boost NFL Music library for football/sports queries",
      "action": {
        "boost_libraries": [
          {
            "library_name": "NFL Music Library",
            "boost_factor": 1.5
          }
        ]
      }
    },
    {
      "id": "library_boost_corporate",
      "type": "library_boost",
      "enabled": false,
      "priority": 90,
      "pattern": "\\b(corporate|business|professional|office|presentation)\\b",
      "description": "Boost corporate-focused libraries",
      "action": {
        "boost_libraries": [
          {
            "library_name": "Corporate",
            "boost_factor": 1.3
          },
          {
            "library_name": "Foundation Music",
            "boost_factor": 1.2
          }
        ]
      }
    },
    {
      "id": "library_boost_cinematic",
      "type": "library_boost",
      "enabled": false,
      "priority": 90,
      "pattern": "\\b(cinematic|epic|orchestral|film|trailer|score)\\b",
      "description": "Boost cinematic libraries for film/trailer queries",
      "action": {
        "boost_libraries": [
          {
            "library_name": "KPM Main Series",
            "boost_factor": 1.4
          },
          {
            "library_name": "Bruton",
            "boost_factor": 1.3
          }
        ]
      }
    },
    {
      "id": "recency_interleaving_pop",
      "type": "recency_interleaving",
      "enabled": false,
      "priority": 80,
      "pattern": "\\b(pop|contemporary|modern|current|fresh)\\b",
      "description": "Interleave recent and vintage pop tracks (favor recent)",
      "action": {
        "recent_count": 8,
        "vintage_count": 4,
        "recent_threshold_months": 12,
        "pattern": "RRRR VRRR VRRR"
      }
    },
    {
      "id": "recency_interleaving_electronic",
      "type": "recency_interleaving",
      "enabled": false,
      "priority": 80,
      "pattern": "\\b(electronic|edm|house|techno|dubstep)\\b",
      "description": "Interleave recent and vintage electronic (heavily favor recent)",
      "action": {
        "recent_count": 9,
        "vintage_count": 3,
        "recent_threshold_months": 18,
        "pattern": "RRRR RRRR VRRV"
      }
    },
    {
      "id": "recency_interleaving_hip_hop",
      "type": "recency_interleaving",
      "enabled": false,
      "priority": 80,
      "pattern": "\\b(hip hop|hip-hop|rap|trap)\\b",
      "description": "Interleave recent and vintage hip hop (heavily favor recent)",
      "action": {
        "recent_count": 9,
        "vintage_count": 3,
        "recent_threshold_months": 12,
        "pattern": "RRRR RRRR VRRV"
      }
    },
    {
      "id": "recency_interleaving_balanced",
      "type": "recency_interleaving",
      "enabled": false,
      "priority": 70,
      "pattern": "\\b(new|latest|recent|updated)\\b",
      "description": "Generic recent search - heavily favor new releases",
      "action": {
        "recent_count": 10,
        "vintage_count": 2,
        "recent_threshold_months": 6,
        "pattern": "RRRR RRRR RRVR"
      }
    },
    {
      "id": "stems_preference",
      "type": "feature_boost",
      "enabled": false,
      "priority": 60,
      "pattern": "\\b(stems?|separate|isolated|multitrack)\\b",
      "description": "Boost tracks with stems when stems are mentioned",
      "action": {
        "boost_field": "has_stems",
        "boost_value": "true",
        "boost_factor": 2.0
      }
    },
    {
      "id": "instrumental_preference",
      "type": "filter_optimization",
      "enabled": false,
      "priority": 60,
      "pattern": "\\b(instrumental|no vocals?|without vocals?|music only)\\b",
      "description": "Auto-filter for instrumental tracks when specified",
      "action": {
        "auto_apply_filter": {
          "field": "vocals",
          "value": "No Vocals",
          "operator": "contains"
        }
      }
    },
    {
      "id": "vocal_preference",
      "type": "filter_optimization",
      "enabled": false,
      "priority": 60,
      "pattern": "\\b(vocals?|sung|singing|lyrics?|singer)\\b",
      "description": "Filter for tracks with vocals when vocals mentioned",
      "action": {
        "auto_apply_filter": {
          "field": "vocals",
          "value": "Female,Male,Children,Choir",
          "operator": "contains_any"
        }
      }
    }
  ],
  "metadata": {
    "last_updated": "2025-12-19",
    "updated_by": "Development",
    "notes": [
      "v2.0.0: Restructured with templates and disabled_rules sections",
      "All original rules moved to disabled_rules for reference",
      "One test rule (subgenre_interleaving_rock) enabled for development",
      "Use globalEnabled to toggle ALL rules on/off via API",
      "Templates section documents available rule types"
    ]
  }
}
